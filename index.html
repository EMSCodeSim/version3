<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>EMS Simulator</title>
<link href="styles/style.css" rel="stylesheet"/>
<style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f2f9ff;
    }
    body {
      min-height: 100vh;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .ems-logo-row {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding-top: 12px;
      padding-bottom: 4px;
      background: #fff;
      transition: padding 0.2s;
    }
    #main-header {
      padding: 8px 0 4px 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      background: none;
    }
    #chat-box {
      flex: 1 1 auto;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px 14px;
      margin: 8px 10px;
      border-radius: 12px;
      background: #fff;
      font-size: 1rem;
      min-height: 120px;
      max-height: 340px;
      box-sizing: border-box;
    }
    .input-row {
      display: flex;
      align-items: center;
      gap: 7px;
      margin: 2px 10px 0 10px;
    }
    #user-input {
      flex: 1;
      padding: 10px;
      font-size: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    #send-button {
      padding: 10px 16px;
      font-size: 15px;
      background: #1a8af8;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    #send-button:active { background: #1566bb; }

    /* Big Speak Button Section */
    .mic-section {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 6px;
      margin-bottom: 8px;
    }
    #mic-button {
      background: #1ca7ec;
      color: white;
      font-size: 1.4rem;
      border: none;
      border-radius: 32px;
      width: 95vw;
      max-width: 360px;
      min-width: 120px;
      height: 54px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      outline: none;
      margin: 0;
      padding: 0 0.5em;
      font-weight: bold;
      letter-spacing: 1px;
      transition: background 0.15s;
    }
    #mic-button span { margin-left: 13px; font-size: 1.2rem; }
    #mic-button:active, #mic-button:focus { background: #1471a6; }
    #mic-button[disabled] { background: #aaa; cursor: not-allowed; }

    .mic-toggles {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 5px;
    }
    .mic-toggle-label {
      user-select: none;
      font-size: 1.06rem;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    @media (max-width: 700px) {
      .ems-logo-row svg { width: 98vw !important; }
      #chat-box { max-height: 320px; min-height: 100px; }
      #mic-button { font-size: 1.14rem; height: 48px; }
      .input-row { margin: 2px 2vw 0 2vw; }
    }
    @media (max-width: 480px) {
      #chat-box { max-height: 260px; min-height: 75px; }
      #mic-button { font-size: 1.05rem; height: 44px; }
    }
  

@media (min-width: 900px) {
  body.learning-mode #user-input {
    max-width: 60%;
  }
}


body.learning-mode #user-input {
  max-width: 60%;
}
body.learning-mode #mainLayout {
  height: calc(100vh - 200px);
}
body.learning-mode #skillSheetPane {
  display: block !important;
  height: 100%;
  background: #f9f9f9;
  border-left: 2px solid #ccc;
  padding-left: 16px;
}


body.learning-mode #mainLayout {
  display: flex;
  flex-direction: row;
  height: 100%;
}

body.learning-mode #simulatorPane {
  flex: 0 0 70%;
  max-width: 70%;
}

body.learning-mode #skillSheetPane {
  display: block;
  flex: 0 0 30%;
  max-width: 30%;
  border-left: 2px solid #ccc;
  padding-left: 12px;
}


body:not(.learning-mode) #chat-box,
body:not(.learning-mode) #user-input,
body:not(.learning-mode) .input-row {
  width: 100%;
  max-width: none;
}

body.learning-mode .input-row,
body.learning-mode #chat-box {
  width: 100%;
  max-width: 100%;
}

body.learning-mode #chat-box {
  margin-right: 12px;
}

body.learning-mode #user-input {
  width: 100%;
}

body.learning-mode #simulatorPane {
  padding-right: 10px;
}

#mainLayout {
  align-items: flex-start;
}
</style>
<style>
.flex-container {
  display: flex;
  flex-direction: row;
}
#simulatorPane {
  width: 70%;
  padding: 10px;
}
#skillSheetPane {
  width: 30%;
  padding: 10px;
  border-left: 2px solid #ccc;
  display: none;
}
.status {
  color: green;
  font-weight: bold;
}
@media (max-width: 900px) {
  #skillSheetPane {
    display: none !important;
  }
}
</style>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const toggle = document.getElementById("learningModeToggle");
  const skillPane = document.getElementById("skillSheetPane");
  toggle.addEventListener("change", () => {
    skillPane.style.display = toggle.checked ? "block" : "none";
  });
});
</script>
</head>
<body>
<!-- EMS CODE SIM Logo -->
<div class="ems-logo-row">
<svg fill="none" height="100" viewbox="0 0 900 100" width="90%" xmlns="http://www.w3.org/2000/svg">
<defs>
<lineargradient gradientunits="userSpaceOnUse" id="grad1" x1="0" x2="900" y1="0" y2="0">
<stop stop-color="#1976d2"></stop>
<stop offset="1" stop-color="#20e3c2"></stop>
</lineargradient>
</defs>
<rect fill="url(#grad1)" height="64" rx="32" width="780" x="60" y="18"></rect>
<text fill="#fff" font-family="Arial Black, Arial, sans-serif" font-size="46" font-weight="bold" letter-spacing="10" text-anchor="middle" x="450" y="65">
        EMS CODE SIM
      </text>
</svg>
</div>
<!-- Scenario Buttons -->
<header id="main-header">
<button id="start-button">Start Scenario</button>
<button id="end-button">End Scenario</button><div id="learning-toggle-bar" style="padding: 8px; font-weight: bold;">
<label><input id="learningModeToggle" type="checkbox"/> Enable Learning Mode</label>
</div>
</header>
<!-- Chat Box -->
<div id="chat-box"></div>
<!-- Input Row -->
<div class="input-row">
<input id="user-input" placeholder="Type your message..." type="text"/>
<button id="send-button">Send</button>
</div>
<!-- Mic Section: Big Speak Button, Toggles Below -->
<div class="mic-section">
<button id="mic-button" title="Tap or hold to speak">
      ðŸŽ¤ <span>Speak</span>
</button>
<div class="mic-toggles">
<label class="mic-toggle-label">
<input id="mute-toggle" type="checkbox"/>
<span>Mute</span>
</label>
<label class="mic-toggle-label">
<input checked="" id="mic-toggle" type="checkbox"/>
<span>Mic On</span>
</label>
</div>
</div>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
      apiKey: "AIzaSyAmpYL8Ywfxkw_h2aMvF2prjiI0m5LYM40",
      authDomain: "ems-code-sim.firebaseapp.com",
      databaseURL: "https://ems-code-sim-default-rtdb.firebaseio.com",
      projectId: "ems-code-sim",
      storageBucket: "ems-code-sim.firebasestorage.app",
      messagingSenderId: "190498607578",
      appId: "1:190498607578:web:4cf6c8e999b027956070e3",
      measurementId: "G-2Q3ZT01YT1"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
<!-- App JS scripts here as needed -->
<script src="scripts/app.js" type="module"></script>
<script src="scripts/grading.js" type="module"></script>
<!-- Mic logic -->
<script>
    const micToggle = document.getElementById('mic-toggle');
    const muteToggle = document.getElementById('mute-toggle');
    const micBtn = document.getElementById('mic-button');
    let smartMicEnabled = micToggle.checked;
    let isMuted = muteToggle.checked;

    micToggle.addEventListener('change', function() {
      smartMicEnabled = micToggle.checked;
      micBtn.disabled = !smartMicEnabled;
    });
    muteToggle.addEventListener('change', function() {
      isMuted = muteToggle.checked;
      // Insert your mute logic here
    });
    micBtn.addEventListener('click', function() {
      if (!smartMicEnabled || isMuted) return;
      if (typeof window.startSmartMic === "function") {
        window.startSmartMic();
      } else {
        console.log("Smart mic activated (stub)");
      }
    });
  </script>
<!-- Learning Mode Toggle -->
<!-- Main Split Layout -->
<div class="flex-container" id="mainLayout" style="display: flex; flex-direction: row; height: 100%; align-items: flex-start; gap: 20px;">
<div id="simulatorPane">
<div class="input-row">
</div>
<div class="mic-section">
</div>
<!-- Existing simulator content should go here -->
</div>
<div id="skillSheetPane">
<h3>Skill Sheet (Live)</h3>
<ul id="skillChecklist">
<li id="EMT-B-MED-13">General Impression <span class="status"></span></li>
<li id="EMT-B-MED-15">AVPU <span class="status"></span></li>
<li id="EMT-B-MED-19">Pulse <span class="status"></span></li>
<li id="EMT-B-MED-20">Blood Pressure <span class="status"></span></li>
<li id="EMT-B-MED-24">Chief Complaint <span class="status"></span></li>
<li id="EMT-B-MED-25">Onset <span class="status"></span></li>
<li id="EMT-B-MED-36">Oxygen <span class="status"></span></li>
</ul>
</div>
</div>
<script src="scripts/app.js" type="module"></script></body>
</html>
