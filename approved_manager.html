<!DOCTYPE html>
<html>
<head>
  <title>Approved Manager ‚Äì EMS Code Sim</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
    h2 { color: #00796b; }
    #reloadBtn {
      background-color: #0f766e; color: white; border: none;
      padding: 10px 20px; font-weight: bold; cursor: pointer;
      margin-bottom: 20px; border-radius: 6px;
    }
    #reloadBtn:hover { background-color: #0d5e55; }

    .entry {
      background: white; border: 1px solid #ccc;
      padding: 1rem; margin-bottom: 1.5rem; border-radius: 8px;
    }
    textarea { width: 100%; height: 60px; margin-bottom: 0.5rem; }
    input, select { width: 100%; margin-bottom: 0.5rem; padding: 0.5rem; }
    button {
      background: #0f766e; color: white; border: none;
      padding: 0.5rem 1rem; margin-right: 0.5rem; cursor: pointer;
    }
    button:hover { background: #0d5e55; }
  </style>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
  <h2>Approved Hardcoded Responses</h2>
  <button id="reloadBtn" onclick="loadApproved()">üîÑ Reload Responses</button>
  <div id="approved-list">Loading approved responses...</div>

  <script>
    const firebaseConfig = {
      databaseURL: "https://emscodesim-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function loadApproved() {
      const container = document.getElementById("approved-list");
      container.innerHTML = "Loading approved responses...";

      db.ref("hardcodedResponses").once("value").then(snapshot => {
        container.innerHTML = "";
        if (!snapshot.exists()) {
          container.innerHTML = "<p>No approved responses found.</p>";
          return;
        }

        snapshot.forEach(child => {
          const data = child.val();
          const key = child.key;

          const div = document.createElement("div");
          div.className = "entry";

          const q = document.createElement("textarea");
          q.value = data.userQuestion || "";

          const a = document.createElement("textarea");
          a.value = data.aiResponse || "";

          const delBtn = document.createElement("button");
          delBtn.textContent = "Delete";
          delBtn.onclick = async () => {
            await db.ref("hardcodedResponses").child(key).remove();
            alert("Deleted.");
            loadApproved();
          };

          div.appendChild(q);
          div.appendChild(a);
          div.appendChild(delBtn);
          container.appendChild(div);
        });
      }).catch(err => {
        container.innerHTML = `<p>‚ùå Failed to load: ${err.message}</p>`;
        console.error("Firebase error:", err);
      });
    }

    document.addEventListener("DOMContentLoaded", loadApproved);
  </script>
</body>
</html>
